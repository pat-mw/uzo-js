{"version":3,"sources":["swirl.js"],"names":["particleCount","particlePropCount","particlePropsLength","rangeY","baseTTL","rangeTTL","baseSpeed","rangeSpeed","baseRadius","rangeRadius","baseHue","rangeHue","noiseSteps","xOff","yOff","zOff","backgroundColor","container","canvas","ctx","center","gradient","tick","simplex","particleProps","positions","velocities","lifeSpans","speeds","sizes","hues","CANVAS_QUERY","setup","console","log","createCanvas","resize","initParticles","draw","i","SimplexNoise","Float32Array","initParticle","x","y","vx","vy","life","ttl","speed","radius","hue","rand","a","width","randRange","set","drawParticles","updateParticle","n","x2","y2","i2","i3","i4","i5","i6","i7","i8","i9","noise3D","TAU","lerp","cos","sin","drawParticle","checkBounds","save","lineCap","lineWidth","strokeStyle","concat","fadeInOut","beginPath","moveTo","lineTo","stroke","closePath","restore","height","document","querySelector","createElement","b","style","appendChild","getContext","innerWidth","innerHeight","window","drawImage","renderGlow","filter","globalCompositeOperation","renderToScreen","clearRect","fillStyle","fillRect","requestAnimationFrame","addEventListener"],"mappings":"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","file":"swirl.js","sourceRoot":"../components/backgroundAnimations","sourcesContent":["\"use strict\";\n\nconst particleCount = 700;\nconst particlePropCount = 9;\nconst particlePropsLength = particleCount * particlePropCount;\nconst rangeY = 100;\nconst baseTTL = 50;\nconst rangeTTL = 150;\nconst baseSpeed = 0.1;\nconst rangeSpeed = 2;\nconst baseRadius = 1;\nconst rangeRadius = 4;\nconst baseHue = 220;\nconst rangeHue = 100;\nconst noiseSteps = 8;\nconst xOff = 0.00125;\nconst yOff = 0.00125;\nconst zOff = 0.0005;\nconst backgroundColor = \"hsla(260,40%,5%,1)\";\n\nlet container;\nlet canvas;\nlet ctx;\nlet center;\nlet gradient;\nlet tick;\nlet simplex;\nlet particleProps;\nlet positions;\nlet velocities;\nlet lifeSpans;\nlet speeds;\nlet sizes;\nlet hues;\n\nconst CANVAS_QUERY = \".bg-effect-canvas[bg-effect='swirl']\";\n\nfunction setup() {\n  console.log('[bg-effect-swirl] initialising.');\n  createCanvas();\n  resize();\n  initParticles();\n  draw();\n}\n\nfunction initParticles() {\n  tick = 0;\n  simplex = new SimplexNoise();\n  particleProps = new Float32Array(particlePropsLength);\n\n  let i;\n\n  for (i = 0; i < particlePropsLength; i += particlePropCount) {\n    initParticle(i);\n  }\n}\n\nfunction initParticle(i) {\n  let x, y, vx, vy, life, ttl, speed, radius, hue;\n\n  x = rand(canvas.a.width);\n  y = center[1] + randRange(rangeY);\n  vx = 0;\n  vy = 0;\n  life = 0;\n  ttl = baseTTL + rand(rangeTTL);\n  speed = baseSpeed + rand(rangeSpeed);\n  radius = baseRadius + rand(rangeRadius);\n  hue = baseHue + rand(rangeHue);\n\n  particleProps.set([x, y, vx, vy, life, ttl, speed, radius, hue], i);\n}\n\nfunction drawParticles() {\n  let i;\n\n  for (i = 0; i < particlePropsLength; i += particlePropCount) {\n    updateParticle(i);\n  }\n}\n\nfunction updateParticle(i) {\n  let i2 = 1 + i,\n    i3 = 2 + i,\n    i4 = 3 + i,\n    i5 = 4 + i,\n    i6 = 5 + i,\n    i7 = 6 + i,\n    i8 = 7 + i,\n    i9 = 8 + i;\n  let n, x, y, vx, vy, life, ttl, speed, x2, y2, radius, hue;\n\n  x = particleProps[i];\n  y = particleProps[i2];\n  n = simplex.noise3D(x * xOff, y * yOff, tick * zOff) * noiseSteps * TAU;\n  vx = lerp(particleProps[i3], cos(n), 0.5);\n  vy = lerp(particleProps[i4], sin(n), 0.5);\n  life = particleProps[i5];\n  ttl = particleProps[i6];\n  speed = particleProps[i7];\n  x2 = x + vx * speed;\n  y2 = y + vy * speed;\n  radius = particleProps[i8];\n  hue = particleProps[i9];\n\n  drawParticle(x, y, x2, y2, life, ttl, radius, hue);\n\n  life++;\n\n  particleProps[i] = x2;\n  particleProps[i2] = y2;\n  particleProps[i3] = vx;\n  particleProps[i4] = vy;\n  particleProps[i5] = life;\n\n  (checkBounds(x, y) || life > ttl) && initParticle(i);\n}\n\nfunction drawParticle(x, y, x2, y2, life, ttl, radius, hue) {\n  ctx.a.save();\n  ctx.a.lineCap = \"round\";\n  ctx.a.lineWidth = radius;\n  ctx.a.strokeStyle = `hsla(${hue},100%,60%,${fadeInOut(life, ttl)})`;\n  ctx.a.beginPath();\n  ctx.a.moveTo(x, y);\n  ctx.a.lineTo(x2, y2);\n  ctx.a.stroke();\n  ctx.a.closePath();\n  ctx.a.restore();\n}\n\nfunction checkBounds(x, y) {\n  return x > canvas.a.width || x < 0 || y > canvas.a.height || y < 0;\n}\n\nfunction createCanvas() {\n  container = document.querySelector(CANVAS_QUERY);\n  console.log('[bg-effect-swirl] found target container:', container);\n  canvas = {\n    a: document.createElement(\"canvas\"),\n    b: document.createElement(\"canvas\"),\n  };\n  canvas.b.style = `\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t`;\n  container.appendChild(canvas.b);\n  ctx = {\n    a: canvas.a.getContext(\"2d\"),\n    b: canvas.b.getContext(\"2d\"),\n  };\n  center = [];\n}\n\nfunction resize() {\n  const { innerWidth, innerHeight } = window;\n\n  canvas.a.width = innerWidth;\n  canvas.a.height = innerHeight;\n\n  ctx.a.drawImage(canvas.b, 0, 0);\n\n  canvas.b.width = innerWidth;\n  canvas.b.height = innerHeight;\n\n  ctx.b.drawImage(canvas.a, 0, 0);\n\n  center[0] = 0.5 * canvas.a.width;\n  center[1] = 0.5 * canvas.a.height;\n}\n\nfunction renderGlow() {\n  ctx.b.save();\n  ctx.b.filter = \"blur(8px) brightness(200%)\";\n  ctx.b.globalCompositeOperation = \"lighter\";\n  ctx.b.drawImage(canvas.a, 0, 0);\n  ctx.b.restore();\n\n  ctx.b.save();\n  ctx.b.filter = \"blur(4px) brightness(200%)\";\n  ctx.b.globalCompositeOperation = \"lighter\";\n  ctx.b.drawImage(canvas.a, 0, 0);\n  ctx.b.restore();\n}\n\nfunction renderToScreen() {\n  ctx.b.save();\n  ctx.b.globalCompositeOperation = \"lighter\";\n  ctx.b.drawImage(canvas.a, 0, 0);\n  ctx.b.restore();\n}\n\nfunction draw() {\n  tick++;\n\n  ctx.a.clearRect(0, 0, canvas.a.width, canvas.a.height);\n\n  ctx.b.fillStyle = backgroundColor;\n  ctx.b.fillRect(0, 0, canvas.a.width, canvas.a.height);\n\n  drawParticles();\n  renderGlow();\n  renderToScreen();\n\n  window.requestAnimationFrame(draw);\n}\n\nwindow.addEventListener(\"load\", setup);\nwindow.addEventListener(\"resize\", resize);\n"]}